(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[220],{4038:function(e,t,a){Promise.resolve().then(a.bind(a,3018))},3018:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var s=a(7437),n=a(2265),i=a(5185),c=a(6070),r=a(2869),l=a(5186),d=a(6815),o=a(6110),x=a(3647),h=a(3464),m=a(9397),u=a(525);let p=(0,a(9205).Z)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);var j=a(1621),y=a(8930);let g="http://localhost:8001/api";function v(){let[e,t]=(0,n.useState)([]),[a,v]=(0,n.useState)([]),[N,f]=(0,n.useState)(!0),[b,w]=(0,n.useState)(!1),[_,S]=(0,n.useState)({account_id:"",type:"income",category:"",amount:"",description:"",transaction_date:new Date().toISOString().split("T")[0]});(0,n.useEffect)(()=>{Z()},[]);let Z=async()=>{let e=localStorage.getItem("token");if(e)try{let[a,s]=await Promise.all([h.Z.get("".concat(g,"/transactions?limit=50"),{headers:{Authorization:"Bearer ".concat(e)}}),h.Z.get("".concat(g,"/accounts"),{headers:{Authorization:"Bearer ".concat(e)}})]);t(a.data||[]),v(s.data||[])}catch(e){console.error("Failed to fetch data",e)}finally{f(!1)}},k=async e=>{e.preventDefault();let t=localStorage.getItem("token");if(t)try{await h.Z.post("".concat(g,"/transactions"),{account_id:_.account_id,type:_.type,category:_.category,amount:parseFloat(_.amount),description:_.description,transaction_date:_.transaction_date},{headers:{Authorization:"Bearer ".concat(t)}}),w(!1),S({account_id:"",type:"income",category:"",amount:"",description:"",transaction_date:new Date().toISOString().split("T")[0]}),Z()}catch(e){var a,s;alert((null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.error)||"Failed to create transaction")}},I=async e=>{if(!confirm("Are you sure you want to delete this transaction?"))return;let t=localStorage.getItem("token");if(t)try{await h.Z.delete("".concat(g,"/transactions/").concat(e),{headers:{Authorization:"Bearer ".concat(t)}}),Z()}catch(e){var a,s;alert((null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.error)||"Failed to delete transaction")}},C=e=>{let t=a.find(t=>t.id===e);return(null==t?void 0:t.name)||"Unknown Account"},A=()=>e.filter(e=>"income"===e.type).reduce((e,t)=>e+t.amount,0),T=()=>e.filter(e=>"expense"===e.type).reduce((e,t)=>e+t.amount,0);return N?(0,s.jsx)(i.Z,{children:(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)("p",{children:"Loading..."})})}):(0,s.jsx)(i.Z,{children:(0,s.jsxs)("div",{className:"space-y-6","data-testid":"transactions-page",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"Transactions"}),(0,s.jsx)("p",{className:"text-gray-500 mt-1",children:"Track your income and expenses"})]}),(0,s.jsxs)(r.z,{onClick:()=>w(!0),"data-testid":"add-transaction-button",children:[(0,s.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Add Transaction"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)(c.Zb,{children:[(0,s.jsx)(c.Ol,{className:"pb-2",children:(0,s.jsx)(c.ll,{className:"text-sm font-medium text-gray-600",children:"Total Income"})}),(0,s.jsx)(c.aY,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("p",{className:"text-3xl font-bold text-green-600",children:["Rp ",A().toLocaleString("id-ID")]}),(0,s.jsx)(u.Z,{className:"h-8 w-8 text-green-200"})]})})]}),(0,s.jsxs)(c.Zb,{children:[(0,s.jsx)(c.Ol,{className:"pb-2",children:(0,s.jsx)(c.ll,{className:"text-sm font-medium text-gray-600",children:"Total Expenses"})}),(0,s.jsx)(c.aY,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("p",{className:"text-3xl font-bold text-red-600",children:["Rp ",T().toLocaleString("id-ID")]}),(0,s.jsx)(p,{className:"h-8 w-8 text-red-200"})]})})]}),(0,s.jsxs)(c.Zb,{children:[(0,s.jsx)(c.Ol,{className:"pb-2",children:(0,s.jsx)(c.ll,{className:"text-sm font-medium text-gray-600",children:"Net Balance"})}),(0,s.jsx)(c.aY,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("p",{className:"text-3xl font-bold text-blue-600",children:["Rp ",(A()-T()).toLocaleString("id-ID")]}),(0,s.jsx)(j.Z,{className:"h-8 w-8 text-blue-200"})]})})]})]}),(0,s.jsxs)(c.Zb,{"data-testid":"transactions-list",children:[(0,s.jsxs)(c.Ol,{children:[(0,s.jsx)(c.ll,{children:"Recent Transactions"}),(0,s.jsx)(c.SZ,{children:"Your latest financial activities"})]}),(0,s.jsx)(c.aY,{children:0===e.length?(0,s.jsxs)("div",{className:"text-center py-12","data-testid":"no-transactions-message",children:[(0,s.jsx)(j.Z,{className:"h-16 w-16 mx-auto text-gray-400 mb-4"}),(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:"No transactions yet. Add your first transaction to start tracking."}),(0,s.jsxs)(r.z,{onClick:()=>w(!0),children:[(0,s.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Add Transaction"]})]}):(0,s.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 transition-colors","data-testid":"transaction-item-".concat(e.id),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"p-3 rounded-full ".concat("income"===e.type?"bg-green-100 text-green-600":"bg-red-100 text-red-600"),children:"income"===e.type?(0,s.jsx)(u.Z,{className:"h-5 w-5"}):(0,s.jsx)(p,{className:"h-5 w-5"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold",children:e.category}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:[C(e.account_id)," â€¢"," ",new Date(e.transaction_date).toLocaleDateString("id-ID")]}),e.description&&(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e.description})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("p",{className:"font-bold text-lg ".concat("income"===e.type?"text-green-600":"text-red-600"),children:["income"===e.type?"+":"-","Rp"," ",e.amount.toLocaleString("id-ID")]}),(0,s.jsx)(r.z,{variant:"ghost",size:"icon",onClick:()=>I(e.id),"data-testid":"delete-transaction-".concat(e.id),children:(0,s.jsx)(y.Z,{className:"h-4 w-4 text-red-500"})})]})]},e.id))})})]}),(0,s.jsx)(o.Vq,{open:b,onOpenChange:w,children:(0,s.jsxs)(o.cZ,{"data-testid":"add-transaction-dialog",children:[(0,s.jsxs)(o.fK,{children:[(0,s.jsx)(o.$N,{children:"Add New Transaction"}),(0,s.jsx)(o.Be,{children:"Record a new income or expense transaction"})]}),(0,s.jsxs)("form",{onSubmit:k,children:[(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d._,{htmlFor:"account",children:"Account"}),(0,s.jsxs)(x.Ph,{value:_.account_id,onValueChange:e=>S({..._,account_id:e}),required:!0,children:[(0,s.jsx)(x.i4,{"data-testid":"transaction-account-select",children:(0,s.jsx)(x.ki,{placeholder:"Select account"})}),(0,s.jsx)(x.Bw,{children:a.map(e=>(0,s.jsx)(x.Ql,{value:e.id,children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d._,{htmlFor:"type",children:"Type"}),(0,s.jsxs)(x.Ph,{value:_.type,onValueChange:e=>S({..._,type:e}),children:[(0,s.jsx)(x.i4,{"data-testid":"transaction-type-select",children:(0,s.jsx)(x.ki,{})}),(0,s.jsxs)(x.Bw,{children:[(0,s.jsx)(x.Ql,{value:"income",children:"Income"}),(0,s.jsx)(x.Ql,{value:"expense",children:"Expense"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d._,{htmlFor:"category",children:"Category"}),(0,s.jsx)(l.I,{id:"category",placeholder:"e.g., Salary, Food, Transport",value:_.category,onChange:e=>S({..._,category:e.target.value}),required:!0,"data-testid":"transaction-category-input"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d._,{htmlFor:"amount",children:"Amount"}),(0,s.jsx)(l.I,{id:"amount",type:"number",step:"0.01",placeholder:"0",value:_.amount,onChange:e=>S({..._,amount:e.target.value}),required:!0,"data-testid":"transaction-amount-input"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d._,{htmlFor:"date",children:"Date"}),(0,s.jsx)(l.I,{id:"date",type:"date",value:_.transaction_date,onChange:e=>S({..._,transaction_date:e.target.value}),"data-testid":"transaction-date-input"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d._,{htmlFor:"description",children:"Description (Optional)"}),(0,s.jsx)(l.I,{id:"description",placeholder:"Add notes...",value:_.description,onChange:e=>S({..._,description:e.target.value}),"data-testid":"transaction-description-input"})]})]}),(0,s.jsxs)(o.cN,{children:[(0,s.jsx)(r.z,{type:"button",variant:"outline",onClick:()=>w(!1),children:"Cancel"}),(0,s.jsx)(r.z,{type:"submit","data-testid":"submit-transaction-button",children:"Add Transaction"})]})]})]})})]})})}}},function(e){e.O(0,[809,444,441,358,971,117,744],function(){return e(e.s=4038)}),_N_E=e.O()}]);