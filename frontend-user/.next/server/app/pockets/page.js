(()=>{var e={};e.id=507,e.ids=[507],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},8791:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},3980:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>d,routeModule:()=>u,tree:()=>o}),a(847),a(1506),a(5866);var s=a(3191),r=a(8716),c=a(7922),n=a.n(c),i=a(5231),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);a.d(t,l);let o=["",{children:["pockets",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,847)),"/app/frontend-user/app/pockets/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,1506)),"/app/frontend-user/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/app/frontend-user/app/pockets/page.tsx"],p="/pockets/page",x={require:a,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/pockets/page",pathname:"/pockets",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},773:(e,t,a)=>{Promise.resolve().then(a.bind(a,1724))},1724:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var s=a(326),r=a(7577),c=a(6211),n=a(2643),i=a(772),l=a(6384),o=a(1048),d=a(2288),p=a(4474),x=a(4464),u=a(3855),h=a(5842),m=a(8091);let g="http://localhost:8001/api";function j(){let[e,t]=(0,r.useState)([]),[a,j]=(0,r.useState)([]),[y,f]=(0,r.useState)(!0),[b,k]=(0,r.useState)(!1),[N,_]=(0,r.useState)({account_id:"",name:"",balance:"",percentage_allocation:""}),[v,P]=(0,r.useState)(""),w=async()=>{let e=localStorage.getItem("token");if(e)try{let[a,s]=await Promise.all([x.Z.get(`${g}/pockets`,{headers:{Authorization:`Bearer ${e}`}}),x.Z.get(`${g}/accounts`,{headers:{Authorization:`Bearer ${e}`}})]);t(a.data||[]),j(s.data||[])}catch(e){console.error("Failed to fetch data",e)}finally{f(!1)}},q=async e=>{e.preventDefault();let t=localStorage.getItem("token");if(!t)return;let a="credit_card"===v&&parseFloat(N.balance)||0;try{await x.Z.post(`${g}/pockets`,{account_id:N.account_id,name:N.name,balance:a,percentage_allocation:parseFloat(N.percentage_allocation)||0},{headers:{Authorization:`Bearer ${t}`}}),k(!1),_({account_id:"",name:"",balance:"",percentage_allocation:""}),P(""),w()}catch(e){alert(e.response?.data?.error||"Failed to create pocket")}},C=async e=>{if(!confirm("Are you sure you want to delete this pocket?"))return;let t=localStorage.getItem("token");if(t)try{await x.Z.delete(`${g}/pockets/${e}`,{headers:{Authorization:`Bearer ${t}`}}),w()}catch(e){alert(e.response?.data?.error||"Failed to delete pocket")}},S=e=>{let t=a.find(t=>t.id===e);return t?.name||"Unknown Account"};return y?s.jsx(c.Z,{children:s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("p",{children:"Loading..."})})}):s.jsx(c.Z,{children:(0,s.jsxs)("div",{className:"space-y-6","data-testid":"pockets-page",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Pockets"}),s.jsx("p",{className:"text-gray-500 mt-1",children:"Organize your money into different pockets"})]}),(0,s.jsxs)(i.z,{onClick:()=>k(!0),"data-testid":"add-pocket-button",children:[s.jsx(u.Z,{className:"h-4 w-4 mr-2"}),"Add Pocket"]})]}),(0,s.jsxs)(n.Zb,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:[(0,s.jsxs)(n.Ol,{children:[s.jsx(n.ll,{className:"text-white",children:"Total in Pockets"}),(0,s.jsxs)(n.SZ,{className:"text-purple-100",children:["Across all ",e.length," pockets"]})]}),s.jsx(n.aY,{children:(0,s.jsxs)("p",{className:"text-4xl font-bold",children:["Rp ",e.reduce((e,t)=>e+t.balance,0).toLocaleString("id-ID")]})})]}),(0,s.jsxs)(n.Zb,{"data-testid":"pockets-list",children:[(0,s.jsxs)(n.Ol,{children:[s.jsx(n.ll,{children:"Your Pockets"}),s.jsx(n.SZ,{children:"Money allocated to different purposes"})]}),s.jsx(n.aY,{children:0===e.length?(0,s.jsxs)("div",{className:"text-center py-12","data-testid":"no-pockets-message",children:[s.jsx(h.Z,{className:"h-16 w-16 mx-auto text-gray-400 mb-4"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"No pockets yet. Create your first pocket to organize your money."}),(0,s.jsxs)(i.z,{onClick:()=>k(!0),children:[s.jsx(u.Z,{className:"h-4 w-4 mr-2"}),"Create Pocket"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,s.jsxs)("div",{className:"p-6 border rounded-lg hover:shadow-md transition-shadow","data-testid":`pocket-item-${e.id}`,children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-purple-100 rounded-full text-purple-600",children:s.jsx(h.Z,{className:"h-6 w-6"})}),s.jsx(i.z,{variant:"ghost",size:"icon",onClick:()=>C(e.id),"data-testid":`delete-pocket-${e.id}`,children:s.jsx(m.Z,{className:"h-4 w-4 text-red-500"})})]}),s.jsx("h3",{className:"font-semibold text-lg mb-2",children:e.name}),s.jsx("p",{className:"text-sm text-gray-500 mb-3",children:S(e.account_id)}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Balance:"}),(0,s.jsxs)("span",{className:"font-bold text-lg",children:["Rp ",e.balance.toLocaleString("id-ID")]})]}),e.percentage_allocation>0&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Allocation:"}),(0,s.jsxs)("span",{className:"text-sm font-medium text-purple-600",children:[e.percentage_allocation,"%"]})]})]})]},e.id))})})]}),s.jsx(d.Vq,{open:b,onOpenChange:k,children:(0,s.jsxs)(d.cZ,{"data-testid":"add-pocket-dialog",children:[(0,s.jsxs)(d.fK,{children:[s.jsx(d.$N,{children:"Add New Pocket"}),s.jsx(d.Be,{children:"Create a new pocket to organize your money by purpose"})]}),(0,s.jsxs)("form",{onSubmit:q,children:[(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(o._,{htmlFor:"account",children:"Parent Account"}),(0,s.jsxs)(p.Ph,{value:N.account_id,onValueChange:e=>{let t=a.find(t=>t.id===e);_({...N,account_id:e,balance:""}),P(t?.type||"")},required:!0,children:[s.jsx(p.i4,{"data-testid":"pocket-account-select",children:s.jsx(p.ki,{placeholder:"Select account"})}),s.jsx(p.Bw,{children:a.map(e=>(0,s.jsxs)(p.Ql,{value:e.id,children:[e.name," (",e.type.replace("_"," "),")"]},e.id))})]}),v&&"credit_card"!==v&&s.jsx("p",{className:"text-xs text-amber-600",children:"⚠️ Balance can only be set for Credit Card accounts"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(o._,{htmlFor:"name",children:"Pocket Name"}),s.jsx(l.I,{id:"name",placeholder:"e.g., Emergency Fund, Vacation",value:N.name,onChange:e=>_({...N,name:e.target.value}),required:!0,"data-testid":"pocket-name-input"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(o._,{htmlFor:"balance",children:["Initial Balance","credit_card"!==v&&s.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(Only for Credit Card)"})]}),s.jsx(l.I,{id:"balance",type:"number",step:"0.01",placeholder:"credit_card"===v?"0":"0 (Read only)",value:"credit_card"===v?N.balance:"0",onChange:e=>{"credit_card"===v&&_({...N,balance:e.target.value})},disabled:"credit_card"!==v,className:"credit_card"!==v?"bg-gray-100 cursor-not-allowed":"","data-testid":"pocket-balance-input"}),"credit_card"===v?s.jsx("p",{className:"text-xs text-gray-500",children:"Set initial balance for this credit card pocket"}):s.jsx("p",{className:"text-xs text-gray-500",children:"Balance is automatically set to 0 for non-credit accounts"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(o._,{htmlFor:"percentage",children:"Allocation Percentage"}),s.jsx(l.I,{id:"percentage",type:"number",step:"0.01",min:"0",max:"100",placeholder:"0",value:N.percentage_allocation,onChange:e=>_({...N,percentage_allocation:e.target.value}),"data-testid":"pocket-percentage-input"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Percentage of income to automatically allocate to this pocket"})]})]}),(0,s.jsxs)(d.cN,{children:[s.jsx(i.z,{type:"button",variant:"outline",onClick:()=>k(!1),children:"Cancel"}),s.jsx(i.z,{type:"submit","data-testid":"submit-pocket-button",children:"Create Pocket"})]})]})]})})]})})}},847:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(8570).createProxy)(String.raw`/app/frontend-user/app/pockets/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[819,8,730,954,755],()=>a(3980));module.exports=s})();